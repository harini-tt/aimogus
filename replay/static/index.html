<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Replay Viewer</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

    <div id="player-roster" class="player-roster hidden"></div>

    <main>
        <div class="map-area" id="map-area">
            <button id="btn-fullscreen" class="fullscreen-btn" title="Toggle fullscreen">&#x26F6;</button>
            <div id="walkway-editor" class="walkway-editor hidden" aria-label="Walkway editor">
                <div class="walkway-editor-row">
                    <button id="btn-edit-walkways" class="walkway-editor-btn" title="Toggle walkway editor (E)">Edit walkways</button>
                    <span class="walkway-editor-coords" id="walkway-editor-coords">(x, y)</span>
                </div>

                <div class="walkway-editor-row">
                    <label class="walkway-editor-label" for="walkway-editor-tool">Tool</label>
                    <select id="walkway-editor-tool" class="walkway-editor-select">
                        <option value="addNode">Add node</option>
                        <option value="addEdge">Add edge</option>
                        <option value="selectMove">Select/drag</option>
                        <option value="setAnchor">Set room anchor</option>
                    </select>
                </div>

                <div class="walkway-editor-row">
                    <label class="walkway-editor-label" for="walkway-editor-room">Room</label>
                    <select id="walkway-editor-room" class="walkway-editor-select"></select>
                </div>

                <div class="walkway-editor-row walkway-editor-actions">
                    <button id="btn-walkway-download" class="walkway-editor-btn" title="Download walkway JSON">Download</button>
                    <label class="walkway-editor-btn walkway-editor-file">
                        Load<input id="walkway-editor-file" type="file" accept="application/json">
                    </label>
                </div>

                <div class="walkway-editor-row walkway-editor-toggles">
                    <label class="walkway-editor-toggle"><input id="walkway-toggle-graph" type="checkbox" checked> Show graph</label>
                    <label class="walkway-editor-toggle"><input id="walkway-toggle-anchors" type="checkbox" checked> Show anchors</label>
                    <label class="walkway-editor-toggle"><input id="walkway-toggle-preview" type="checkbox"> Preview path</label>
                    <label class="walkway-editor-toggle"><input id="walkway-toggle-magnifier" type="checkbox"> Magnifier</label>
                </div>

                <div class="walkway-editor-row hidden" id="walkway-preview-row">
                    <label class="walkway-editor-label" for="walkway-editor-room-to">To</label>
                    <select id="walkway-editor-room-to" class="walkway-editor-select"></select>
                </div>

                <canvas id="walkway-magnifier" class="walkway-magnifier hidden" width="180" height="180"></canvas>
                <div class="walkway-editor-hint" id="walkway-editor-hint"></div>
            </div>
            <canvas id="game-map" width="980" height="561"></canvas>

            <div class="task-progress-container">
                <span class="task-progress-label">Tasks</span>
                <div class="task-progress-bar">
                    <div id="task-progress-fill" class="task-progress-fill"></div>
                </div>
                <span id="task-progress-text" class="task-progress-text">0%</span>
            </div>

            <div class="controls-bar">
                <div class="controls-buttons">
                    <button id="btn-start" title="Jump to start">|&lt;</button>
                    <button id="btn-prev-turn" title="Previous turn">&lt;&lt;</button>
                    <button id="btn-prev" title="Previous event">&lt;</button>
                    <button id="btn-play" title="Play/Pause">&#9654;</button>
                    <button id="btn-next" title="Next event">&gt;</button>
                    <button id="btn-next-turn" title="Next turn">&gt;&gt;</button>
                    <button id="btn-end" title="Jump to end">&gt;|</button>
                </div>
                <div class="timeline-container">
                    <input type="range" id="timeline" min="0" max="0" value="0">
                </div>
                <div class="turn-info">
                    <span id="turn-display">T0</span>
                    <span id="phase-display" class="phase-badge">--</span>
                    <span id="game-result" class="game-result hidden"></span>
                </div>
                <div class="speed-control">
                    <button class="speed-btn" data-speed="0.5">0.5x</button>
                    <button class="speed-btn active" data-speed="1">1x</button>
                    <button class="speed-btn" data-speed="2">2x</button>
                    <button class="speed-btn" data-speed="4">4x</button>
                </div>
            </div>

            <div id="meeting-panel" class="meeting-panel hidden">
                <div class="meeting-header">
                    <h3 id="meeting-title">Emergency Meeting</h3>
                    <button id="btn-close-chat" class="chat-close-btn" title="Close chat">&times;</button>
                </div>
                <div id="speech-bubbles" class="speech-bubbles"></div>
                <div id="vote-results" class="vote-results hidden"></div>
            </div>

            <button id="btn-chat-toggle" class="chat-toggle-btn hidden" title="Toggle meeting chat">&#128172;</button>
        </div>

        <aside class="activity-sidebar">
            <h3>Activity Log</h3>
            <div id="activity-log" class="activity-log"></div>
        </aside>
    </main>

    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-text">Loading...</div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
